***************
*** 26,31 ****
  #include "..\tcpip.h"
  #include "winip.h"
  #include "..\..\NmapOps.h"
  
  #ifndef SIO_RCVALL
  #define IOC_VENDOR 0x18000000
--- 26,32 ----
  #include "..\tcpip.h"
  #include "winip.h"
  #include "..\..\NmapOps.h"
+ #undef socket
  
  #ifndef SIO_RCVALL
  #define IOC_VENDOR 0x18000000
***************
*** 67,73 ****
  		fatal("rawrecv: cannot open raw socket\n");
  
  	if(bind(s, (struct sockaddr*)&sin, sizeof(sin)))
- 		fatal("rawrecv_open: failed to bind to %s\n", inet_ntoa(sin.sin_addr));
  
  	if(setsockopt(s, SOL_SOCKET, SO_RCVBUF, (char*)&bufsz, sizeof(bufsz)))
  		fatal("rawrecv_open: failed to set buffer size\n");
--- 68,74 ----
  		fatal("rawrecv: cannot open raw socket\n");
  
  	if(bind(s, (struct sockaddr*)&sin, sizeof(sin)))
+ 		fatal("rawrecv_open: failed to bind to %s (%d)\n", inet_ntoa(sin.sin_addr), WSAGetLastError());
  
  	if(setsockopt(s, SOL_SOCKET, SO_RCVBUF, (char*)&bufsz, sizeof(bufsz)))
  		fatal("rawrecv_open: failed to set buffer size\n");
